s3_endpoint: eu-west-1
site: public
gzip: true
index_document: index.html
error_document: pages/404
cloudfront_wildcard_invalidation: true
cloudfront_invalidate_root: true
ignore_on_server: _DELETE_NOTHING_ON_THE_S3_BUCKET_
cache_control:
  "*.png": public, max-age=<%= 60 * 60 * 24 * 90 %>
  "*.svg": public, max-age=<%= 60 * 60 * 24 * 90 %>
  "*.jpg": public, max-age=<%= 60 * 60 * 24 * 90 %>
  "*.jpeg": public, max-age=<%= 60 * 60 * 24 * 90 %>
  "*.js": public, max-age=<%= 60 * 60 * 24 * 30 %>
  "*.css": public, max-age=<%= 60 * 60 * 24 * 30 %>
  "*.otf": public, max-age=<%= 60 * 60 * 24 * 30 %>
  "*": no-cache, no-store
s3_id: <%= ENV['S3_ID'] %>
s3_secret: <%= ENV['S3_SECRET'] %>

# change bucket based on travis ENV
# chechk for PR required as branch in PR's always is master
<% if ENV['TRAVIS_TAG'].to_s != '' %>
s3_bucket: www2.honeypot.io
cloudfront_distribution_id: E21RQMGDUM8ALN
cloudfront_distribution_config:
  aliases:
    quantity: 1
    items:
      CNAME: www2.honeypot.io
<% else %>
s3_bucket: staging.honeypot.io
cloudfront_distribution_id: E3JUH1MUHO6XDX
cloudfront_distribution_config:
  aliases:
    quantity: 1
    items:
      CNAME: staging.honeypot.io
<% end %>
<% if ENV['PREFIX_FOLDER'] != '' %>
s3_key_prefix: <%= ENV['PREFIX_FOLDER'] %>
<% end %>

routing_rules:
  - condition:
      key_prefix_equals: admin
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: admin
  - condition:
      key_prefix_equals: api
    redirect:
      host_name: <%= ENV['API_HOST'] %>
      replace_key_prefix_with: api
  - condition:
      key_prefix_equals: talents
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: talents
  - condition:
      key_prefix_equals: company
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: company
  - condition:
      key_prefix_equals: companies
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: companies
  - condition:
      key_prefix_equals: users/sign_out
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: users/sign_out
  - condition:
      key_prefix_equals: users/password
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: users/password
  - condition:
      key_prefix_equals: users/cancel
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: users/cancel
  - condition:
      key_prefix_equals: users/confirmation
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: users/confirmation
  - condition:
      key_prefix_equals: users/invitation
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: users/invitation
  - condition:
      key_prefix_equals: registrations/new
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: users/sign_up
  - condition:
      key_prefix_equals: invitation/accept_refer_a_friend
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: invitation/accept_refer_a_friend
  - condition:
      key_prefix_equals: ref
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: ref
  - condition:
      key_prefix_equals: employers/request-invite
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: employers/request-invite
  - condition:
      key_prefix_equals: profile
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: profile
  - condition:
      key_prefix_equals: interview-invites
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: interview-invites
  - condition:
      key_prefix_equals: refer
    redirect:
      host_name: <%= ENV['APP_HOST'] %>
      replace_key_prefix_with: refer
  - condition:
      key_prefix_equals: blog
    redirect:
      host_name: <%= ENV['BLOG_HOST'] || 'staging-blog-honeypot.herokuapp.com' %>
      replace_key_prefix_with: /
